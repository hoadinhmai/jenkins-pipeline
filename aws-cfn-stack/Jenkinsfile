pipeline {
    agent any

parameters {
    string(name: 'PERSON', defaultValue: 'Mr Jenkins', description: 'Who should I say hello to?')
}

stages{
        stage('Validate CFN template'){
            steps {
                echo 'Vaidating template'
                sh '~/Library/Python/2.7/bin/aws cloudformation validate-template --template-body file:///Users/hoa/code/cloudformation/very_sample1.json'
            }
            post {
                success {
                    echo 'CFN has been validated successfully!'
                }
            }
        }

        stage('Deploy CFN stack'){
            steps {
                echo 'Building stack'
                sh '~/Library/Python/2.7/bin/aws cloudformation create-stack --stack-name myteststack --template-url file:///Users/hoa/code/cloudformation/very_sample1.json'
            }
            post {
                success {
                    echo 'CFN stack creation completed successfully!'
                }
            }
        }

    }
}
